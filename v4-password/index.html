<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Document</title>
  <script
      lang="text/javascript"
      src="https://unpkg.com/@formsort/custom-question-api"
  ></script>
  <!-- zxcvbn: password strength estimator inspired by password crackers -->
  <script src="https://cdn.jsdelivr.net/npm/zxcvbn@4.4.2/dist/zxcvbn.min.js"></script>
  <style>
    /* Body margin to match Formsort styles */
    body {
      margin: 0;
    }

    .password-container {
    }

    .password-container .password-strength {
      display: flex;
      justify-content: space-between;
      background-color: #e0e0e0;
      border-radius: 2px;
      height: 4px;
      margin: 8px 0 16px;
    }

    .password-container .password-strength div {
      /*height: 100%;*/
      /*transition: width 0.3s;*/
      flex: 1; /* Make each segment take equal space */
      margin-right: 4px; /* Space between segments */
      background-color: #d1d5db; /* Default gray color */
      border-radius: 4px; /* Rounded corners */
      transition: background-color 0.3s; /* Smooth transition for color change */
    }

    .password-strength div.strength-1 {
      background-color: #ff4d4d; /* Very Weak */
    }

    .password-strength div.strength-2 {
      background-color: #ffcc00; /* Weak */
    }

    .password-strength div.strength-3 {
      background-color: #ffdb58; /* Fair */
    }

    .password-strength div.strength-4 {
      background-color: #66cc66; /* Good */
    }

    .password-strength div.strength-5 {
      background-color: #33cc33; /* Strong */
    }

    .password-container .strength-label {
      font-size: 14px;
      color: #555;
      margin-bottom: 16px;
    }

    .password-container .toggle-btn {
      background: none;
      border: none;
      color: #0073e6;
      font-size: 14px;
      cursor: pointer;
      position: absolute;
      right: 16px;
      top: 38px;
    }

    .password-container .toggle-btn:focus {
      outline: none;
    }

    input {
      background-color: rgba(255, 255, 255, 1);
      border-radius: 8px;
      border: 1px solid rgba(220, 223, 232, 1);
      font-family: "VC Cardinal Wide", sans-serif;
      font-size: 1rem;
      font-style: normal;
      font-weight: 300;
      margin: 8px 0;
      outline: none;
      padding: 16px;
      width: 95%;
    }

    input:focus {
      border-color: rgb(9, 26, 79);
    }

    /*#strength-meter {*/
    /*  margin-top: 10px;*/
    /*  height: 10px;*/
    /*  width: 100%;*/
    /*  background-color: #e0e0e0;*/
    /*}*/

    /*#strength-meter div {*/
    /*  height: 100%;*/
    /*  width: 0;*/
    /*  transition: width 0.5s;*/
    /*}*/
  </style>
</head>
<body>

<div class="password-container">
  <div style="position: relative;">
    <input type="password" id="iframe-pwd">
    <button class="toggle-btn" id="togglePassword">Show</button>
  </div>

<!--  <div class="password-strength" id="password-strength">-->
<!--    <div class="strength-1"></div>-->
<!--    <div class="strength-2"></div>-->
<!--    <div class="strength-3"></div>-->
<!--    <div class="strength-4"></div>-->
<!--    <div class="strength-5"></div>-->
<!--  </div>-->
<!--  <div class="strength-label" id="strength-label">Password strength</div>-->

  <ul id="validation-list">
    <li id="length-check">At least 8 characters long</li>
    <li id="uppercase-check">Contains an uppercase letter</li>
    <li id="lowercase-check">Contains a lowercase letter</li>
    <li id="number-symbol-check">Contains a number or symbol</li>
  </ul>
</div>

<!--<div id="strength-meter">-->
<!--  <div id="strength-bar"></div>-->
<!--</div>-->
<!--<p id="strength-text">Strength: </p>-->


<script>
  // Helper function to update validation styles
  function styleRequirements(element, isValid) {
    if (isValid) {
      element.style.color = 'green';
      element.classList.remove('invalid');
    }
    else {
      element.style.color = 'red';
      element.classList.add('invalid');
    }
  }

  <!--  Only allow this page to be seen from formsort flow-->
  // if (window.top !== window.self) {
  //   const allowedDomains = [
  //     "https://www.wearise.com/",
  //     "https://onboarding.wearise.com/",
  //     "https://studio.formsort.com/"
  //   ];
  //
  //   const isAllowed = allowedDomains.some(domain => document.referrer.startsWith(domain));
  //
  //   // Page is inside an iframe
  //   if (!isAllowed) {
  //     // If the referrer is not the authorized domain, redirect or show a message
  //     document.body.innerHTML = 'This content can only be viewed from an authorized source.';
  //   }
  // }
  // else {
  //   // Not inside an iframe, you can redirect or hide content here
  //   window.location.href = 'https://wearise.com';
  // }

  // Help formsort size iframe correctly
  window.addEventListener('load', () => {
    const width = document.body.offsetWidth;
    const height = document.body.offsetHeight;
    formsort.setQuestionSize(width, height);
  })

  // Show or Hide password
  const togglePasswordButton = document.getElementById('togglePassword');
  togglePasswordButton.addEventListener('click', () => {
    const type = pwdInput.type === 'password' ? 'text' : 'password';
    pwdInput.type = type;
    togglePasswordButton.textContent = type === 'password' ? 'Show' : 'Hide';
  });

  const pwdInput = document.querySelector('#iframe-pwd');
  const strengthMeter = document.getElementById('strength-bar');
  const strengthText = document.getElementById('strength-text');

  const validationList = document.getElementById('validation-list');

  // Validation list items
  const lengthCheck = document.getElementById('length-check');
  const uppercaseCheck = document.getElementById('uppercase-check');
  const lowercaseCheck = document.getElementById('lowercase-check');
  const numberSymbolCheck = document.getElementById('number-symbol-check');



  let isPwdValid = false;

  // Password strength meter using zxcvbn
  pwdInput.addEventListener('input', function () {
    const passwordValue = pwdInput.value;

    // Validation rules
    const lengthValid = passwordValue.length >= 8;
    const uppercaseValid = /[A-Z]/.test(passwordValue);
    const lowercaseValid = /[a-z]/.test(passwordValue);
    const numberSymbolValid = /[\d\W]/.test(passwordValue); // Matches any digit or non-word character

    // Update validation messages
    styleRequirements(lengthCheck, lengthValid);
    styleRequirements(uppercaseCheck, uppercaseValid);
    styleRequirements(lowercaseCheck, lowercaseValid);
    styleRequirements(numberSymbolCheck, numberSymbolValid);



    // const result = zxcvbn(passwordValue);
    // updateStrengthMeter(result.score);


    // // Map the score to a percentage for the strength bar
    // const score = result["score"];
    // const strengthPercentage = (score + 1) * 20; // Score is 0-4, so we map to 0-100%
    //
    // // Update strength bar and text
    // strengthMeter.style.width = `${strengthPercentage}%`;
    //
    // let strengthLabel = '';
    // switch (score) {
    //   case 0:
    //     strengthLabel = 'Very Weak';
    //     strengthMeter.style.backgroundColor = '#ff4d4d'; // Red
    //     break;
    //   case 1:
    //     strengthLabel = 'Weak';
    //     strengthMeter.style.backgroundColor = '#ffcc00'; // Yellow
    //     break;
    //   case 2:
    //     strengthLabel = 'Fair';
    //     strengthMeter.style.backgroundColor = '#ffff66'; // Light Yellow
    //     break;
    //   case 3:
    //     strengthLabel = 'Good';
    //     strengthMeter.style.backgroundColor = '#66cc66'; // Light Green
    //     isPwdValid = true;
    //     break;
    //   case 4:
    //     strengthLabel = 'Strong';
    //     strengthMeter.style.backgroundColor = '#33cc33'; // Green
    //     isPwdValid = true;
    //     break;
    // }
    //
    // strengthText.textContent = `Strength: ${strengthLabel}`;



    console.log("isPwdValid", isPwdValid)

    // If password is valid and the score is 3 or 4, set the answer value
    // if (isPwdValid && typeof formsort !== 'undefined') {
    //   formsort.setAnswerValue(passwordValue);
    // }
  });
  //
  // // Ensure that the library is loaded before using it
  // document.addEventListener("DOMContentLoaded", function () {
  //   // Check the Formsort library is available
  //   if (typeof formsort !== 'undefined') {
  //     if (isPwdValid) {
  //       inputEl.addEventListener('change', e => {
  //         formsort.setAnswerValue(e.target.value);
  //       })
  //     }
  //   }
  // })

  function updateStrengthMeter(score) {
    strengthBars.forEach((bar, index) => {
      bar.style.width = index <= score ? '20%' : '0';
    });

    const strengthText = [
      'Very weak',
      'Weak',
      'Fair',
      'Good',
      'Strong'
    ];
    strengthLabel.textContent = strengthText[score];
  }


</script>
</body>
</html>
